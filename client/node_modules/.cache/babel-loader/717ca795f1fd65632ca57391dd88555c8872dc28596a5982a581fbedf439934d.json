{"ast":null,"code":"// client/src/components/QuizGame/QuizGame.jsx\nimport React,{useEffect,useMemo,useState}from\"react\";import{useLocation,useParams}from\"react-router-dom\";import\"./QuizGame.css\";// ✅ טקסטים בתוך הקובץ כדי שלא יהיו תלותים חיצוניים\nconst Texts={loading_questions:\"Loading questions...\",no_quiz_selected:\"No quiz selected\",correct_answer_alert:\"Correct! Great job!\",wrong_answer_alert:\"Oops! That's not correct.\",citizen_counter_label:\"Citizens:\",end_title:\"Quiz finished!\",end_summary:(score,total)=>\"You scored \".concat(score,\" out of \").concat(total,\".\"),restart:\"Restart\"};// ✅ ספרייטים (ודאי שהקבצים קיימים תחת src/assets)\nimport civ1 from\"../../assets/civ1.png\";import civ2 from\"../../assets/civ2.png\";import civ3 from\"../../assets/civ3.png\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CIVILIANS=[civ1,civ2,civ3];/** קבלת quizId: פרופס / פרמטר ב־URL (/game/:id) / פרמטר בשורת כתובת (?quizId=) / ברירת מחדל 1 */function useQuizId(propQuizId){var _ref,_ref2;const{id}=useParams();const qs=new URLSearchParams(useLocation().search).get(\"quizId\");const raw=(_ref=(_ref2=propQuizId!==null&&propQuizId!==void 0?propQuizId:id)!==null&&_ref2!==void 0?_ref2:qs)!==null&&_ref!==void 0?_ref:1;const n=Number(raw);return Number.isFinite(n)&&n>0?n:1;}/** המרה ל־0-based מכל סוג ערך שמגיע מהשרת */function normalizeCorrectIndex(_ref3){let{baseAnswers,filteredAnswers,rawIndex,rawText}=_ref3;// 1) אם יש טקסט תשובה נכונה – נאתר אותו אחרי הסינון\nif(rawText!=null){const t=String(rawText).trim();const byText=filteredAnswers.findIndex(a=>String(a).trim()===t);if(byText!==-1)return byText;}// 2) אם יש אינדקס מהשרת – ננסה גם 1-based וגם 0-based על בסיס BEFORE-filter\nif(rawIndex!=null){const num=parseInt(String(rawIndex).trim(),10);if(!Number.isNaN(num)){// 1-based על בסיס המקור (כולל null/undefined)\nif(num>=1&&num<=baseAnswers.length){const txt=baseAnswers[num-1];const byText=filteredAnswers.findIndex(a=>a===txt);if(byText!==-1)return byText;}// 0-based על בסיס המקור\nif(num>=0&&num<baseAnswers.length){const txt=baseAnswers[num];const byText=filteredAnswers.findIndex(a=>a===txt);if(byText!==-1)return byText;}// אם לא הצלחנו למפות דרך טקסט – ננסה ישירות על filtered\nif(num>=1&&num<=filteredAnswers.length)return num-1;if(num>=0&&num<filteredAnswers.length)return num;}}// 3) ברירת מחדל\nreturn 0;}/** נרמול רשומת שאלה אחת מכל פורמט נפוץ */function normalizeRow(row){var _ref4,_ref5,_ref6,_row$question,_ref11,_row$correctAnswer2,_ref12,_ref13,_ref14,_row$correctAnswerInd2;const question=(_ref4=(_ref5=(_ref6=(_row$question=row===null||row===void 0?void 0:row.question)!==null&&_row$question!==void 0?_row$question:row===null||row===void 0?void 0:row.question_text)!==null&&_ref6!==void 0?_ref6:row===null||row===void 0?void 0:row.q_text)!==null&&_ref5!==void 0?_ref5:row===null||row===void 0?void 0:row.title)!==null&&_ref4!==void 0?_ref4:\"\";// answers כבר כמערך?\nif(Array.isArray(row===null||row===void 0?void 0:row.answers)){var _ref7,_ref8,_ref9,_row$correctAnswerInd,_ref10,_row$correctAnswer;const answers=row.answers.map(x=>x==null?\"\":String(x));const idx=normalizeCorrectIndex({baseAnswers:answers,filteredAnswers:answers,rawIndex:(_ref7=(_ref8=(_ref9=(_row$correctAnswerInd=row.correctAnswerIndex)!==null&&_row$correctAnswerInd!==void 0?_row$correctAnswerInd:row.correct_answer_index)!==null&&_ref9!==void 0?_ref9:row.correct_answer)!==null&&_ref8!==void 0?_ref8:row.correct)!==null&&_ref7!==void 0?_ref7:null,rawText:(_ref10=(_row$correctAnswer=row.correctAnswer)!==null&&_row$correctAnswer!==void 0?_row$correctAnswer:row.correct_answer_text)!==null&&_ref10!==void 0?_ref10:null});return{question,answers,correctAnswerIndex:idx};}// עמודות answer_1..answer_4\nconst baseAnswers=[row===null||row===void 0?void 0:row.answer_1,row===null||row===void 0?void 0:row.answer_2,row===null||row===void 0?void 0:row.answer_3,row===null||row===void 0?void 0:row.answer_4].map(x=>x==null?null:String(x));const answers=baseAnswers.filter(x=>x!==null);const correctText=(_ref11=(_row$correctAnswer2=row===null||row===void 0?void 0:row.correctAnswer)!==null&&_row$correctAnswer2!==void 0?_row$correctAnswer2:row===null||row===void 0?void 0:row.correct_answer_text)!==null&&_ref11!==void 0?_ref11:null;const rawIndex=(_ref12=(_ref13=(_ref14=(_row$correctAnswerInd2=row===null||row===void 0?void 0:row.correctAnswerIndex)!==null&&_row$correctAnswerInd2!==void 0?_row$correctAnswerInd2:row===null||row===void 0?void 0:row.correct_answer_index)!==null&&_ref14!==void 0?_ref14:row===null||row===void 0?void 0:row.correct_answer)!==null&&_ref13!==void 0?_ref13:// יש מקרים שהעמודה נקראת כך\nrow===null||row===void 0?void 0:row.correct)!==null&&_ref12!==void 0?_ref12:null;const idx=normalizeCorrectIndex({baseAnswers,filteredAnswers:answers,rawIndex,rawText:correctText});return{question,answers,correctAnswerIndex:idx};}const QuizGame=_ref15=>{let{quizId:propQuizId,onFinish}=_ref15;const quizId=useQuizId(propQuizId);const[questions,setQuestions]=useState([]);const[currentIndex,setCurrentIndex]=useState(0);const[feedback,setFeedback]=useState(\"\");const[citizenCount,setCitizenCount]=useState(1);const[score,setScore]=useState(0);const[isLocked,setIsLocked]=useState(false);const[isLoading,setIsLoading]=useState(false);const[loadError,setLoadError]=useState(\"\");const[finished,setFinished]=useState(false);// טעינת שאלות\nuseEffect(()=>{let cancel=false;async function load(){setIsLoading(true);setLoadError(\"\");setQuestions([]);setCurrentIndex(0);setFeedback(\"\");setCitizenCount(1);setScore(0);setIsLocked(false);setFinished(false);try{const res=await fetch(\"/api/questions/\".concat(quizId));if(!res.ok)throw new Error(\"HTTP \".concat(res.status));const raw=await res.json();const normalized=(Array.isArray(raw)?raw:[]).map(normalizeRow);if(!cancel)setQuestions(normalized);}catch(e){console.error(\"Failed to fetch questions:\",e);if(!cancel)setLoadError(\"Failed to load questions.\");}finally{if(!cancel)setIsLoading(false);}}load();return()=>{cancel=true;};},[quizId]);const currentQuestion=useMemo(()=>questions.length?questions[currentIndex]:null,[questions,currentIndex]);if(!quizId)return/*#__PURE__*/_jsx(\"div\",{children:Texts.no_quiz_selected});if(isLoading)return/*#__PURE__*/_jsx(\"div\",{children:Texts.loading_questions});if(loadError)return/*#__PURE__*/_jsx(\"div\",{children:loadError});if(!currentQuestion)return/*#__PURE__*/_jsx(\"div\",{children:Texts.loading_questions});const handleAnswerClick=index=>{if(isLocked||finished)return;setIsLocked(true);const isCorrect=index===currentQuestion.correctAnswerIndex;if(isCorrect){setFeedback(Texts.correct_answer_alert);setScore(s=>s+1);setCitizenCount(prev=>Math.min(prev+1,CIVILIANS.length));}else{setFeedback(Texts.wrong_answer_alert);setCitizenCount(prev=>Math.max(prev-1,1));}setTimeout(()=>{setFeedback(\"\");setIsLocked(false);setCurrentIndex(prev=>{const next=prev+1;if(next<questions.length)return next;// סיום\nconst finalScore=isCorrect?score+1:score;setFinished(true);if(typeof onFinish===\"function\"){onFinish({score:finalScore,total:questions.length});}return prev;});},800);};const handleRestart=()=>{setCurrentIndex(0);setFeedback(\"\");setCitizenCount(1);setScore(0);setIsLocked(false);setFinished(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"quiz-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"left-side\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"info-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"citizen-count-box\",children:[Texts.citizen_counter_label,\" \",citizenCount]}),/*#__PURE__*/_jsx(\"div\",{className:\"feedback-box \".concat(feedback?\"visible\":\"\"),children:feedback}),/*#__PURE__*/_jsx(\"div\",{className:\"game-frame\",children:/*#__PURE__*/_jsx(\"div\",{className:\"citizens-panel\",children:CIVILIANS.slice(0,citizenCount).map((src,idx)=>/*#__PURE__*/_jsx(\"img\",{src:src,alt:\"Citizen \".concat(idx+1),className:\"citizen-img\"},idx))})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"right-side\",children:finished?/*#__PURE__*/_jsxs(\"div\",{className:\"end-screen\",children:[/*#__PURE__*/_jsx(\"h3\",{children:Texts.end_title}),/*#__PURE__*/_jsx(\"p\",{children:Texts.end_summary(score,questions.length)}),/*#__PURE__*/_jsx(\"button\",{className:\"restart-button\",onClick:handleRestart,children:Texts.restart})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"question-box\",children:currentQuestion.question}),/*#__PURE__*/_jsx(\"div\",{className:\"answers-grid\",children:currentQuestion.answers.map((ans,idx)=>/*#__PURE__*/_jsx(\"button\",{className:\"answer-button\",onClick:()=>handleAnswerClick(idx),disabled:isLocked,children:ans},idx))})]})})]});};export default QuizGame;","map":{"version":3,"names":["React","useEffect","useMemo","useState","useLocation","useParams","Texts","loading_questions","no_quiz_selected","correct_answer_alert","wrong_answer_alert","citizen_counter_label","end_title","end_summary","score","total","concat","restart","civ1","civ2","civ3","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CIVILIANS","useQuizId","propQuizId","_ref","_ref2","id","qs","URLSearchParams","search","get","raw","n","Number","isFinite","normalizeCorrectIndex","_ref3","baseAnswers","filteredAnswers","rawIndex","rawText","t","String","trim","byText","findIndex","a","num","parseInt","isNaN","length","txt","normalizeRow","row","_ref4","_ref5","_ref6","_row$question","_ref11","_row$correctAnswer2","_ref12","_ref13","_ref14","_row$correctAnswerInd2","question","question_text","q_text","title","Array","isArray","answers","_ref7","_ref8","_ref9","_row$correctAnswerInd","_ref10","_row$correctAnswer","map","x","idx","correctAnswerIndex","correct_answer_index","correct_answer","correct","correctAnswer","correct_answer_text","answer_1","answer_2","answer_3","answer_4","filter","correctText","QuizGame","_ref15","quizId","onFinish","questions","setQuestions","currentIndex","setCurrentIndex","feedback","setFeedback","citizenCount","setCitizenCount","setScore","isLocked","setIsLocked","isLoading","setIsLoading","loadError","setLoadError","finished","setFinished","cancel","load","res","fetch","ok","Error","status","json","normalized","e","console","error","currentQuestion","children","handleAnswerClick","index","isCorrect","s","prev","Math","min","max","setTimeout","next","finalScore","handleRestart","className","slice","src","alt","onClick","ans","disabled"],"sources":["D:/QuizQuest/QuizQuest/client/src/components/QuizGame/QuizGame.jsx"],"sourcesContent":["// client/src/components/QuizGame/QuizGame.jsx\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { useLocation, useParams } from \"react-router-dom\";\r\nimport \"./QuizGame.css\";\r\n\r\n// ✅ טקסטים בתוך הקובץ כדי שלא יהיו תלותים חיצוניים\r\nconst Texts = {\r\n    loading_questions: \"Loading questions...\",\r\n    no_quiz_selected: \"No quiz selected\",\r\n    correct_answer_alert: \"Correct! Great job!\",\r\n    wrong_answer_alert: \"Oops! That's not correct.\",\r\n    citizen_counter_label: \"Citizens:\",\r\n    end_title: \"Quiz finished!\",\r\n    end_summary: (score, total) => `You scored ${score} out of ${total}.`,\r\n    restart: \"Restart\",\r\n};\r\n\r\n// ✅ ספרייטים (ודאי שהקבצים קיימים תחת src/assets)\r\nimport civ1 from \"../../assets/civ1.png\";\r\nimport civ2 from \"../../assets/civ2.png\";\r\nimport civ3 from \"../../assets/civ3.png\";\r\nconst CIVILIANS = [civ1, civ2, civ3];\r\n\r\n/** קבלת quizId: פרופס / פרמטר ב־URL (/game/:id) / פרמטר בשורת כתובת (?quizId=) / ברירת מחדל 1 */\r\nfunction useQuizId(propQuizId) {\r\n    const { id } = useParams();\r\n    const qs = new URLSearchParams(useLocation().search).get(\"quizId\");\r\n    const raw = propQuizId ?? id ?? qs ?? 1;\r\n    const n = Number(raw);\r\n    return Number.isFinite(n) && n > 0 ? n : 1;\r\n}\r\n\r\n/** המרה ל־0-based מכל סוג ערך שמגיע מהשרת */\r\nfunction normalizeCorrectIndex({ baseAnswers, filteredAnswers, rawIndex, rawText }) {\r\n    // 1) אם יש טקסט תשובה נכונה – נאתר אותו אחרי הסינון\r\n    if (rawText != null) {\r\n        const t = String(rawText).trim();\r\n        const byText = filteredAnswers.findIndex((a) => String(a).trim() === t);\r\n        if (byText !== -1) return byText;\r\n    }\r\n\r\n    // 2) אם יש אינדקס מהשרת – ננסה גם 1-based וגם 0-based על בסיס BEFORE-filter\r\n    if (rawIndex != null) {\r\n        const num = parseInt(String(rawIndex).trim(), 10);\r\n        if (!Number.isNaN(num)) {\r\n            // 1-based על בסיס המקור (כולל null/undefined)\r\n            if (num >= 1 && num <= baseAnswers.length) {\r\n                const txt = baseAnswers[num - 1];\r\n                const byText = filteredAnswers.findIndex((a) => a === txt);\r\n                if (byText !== -1) return byText;\r\n            }\r\n            // 0-based על בסיס המקור\r\n            if (num >= 0 && num < baseAnswers.length) {\r\n                const txt = baseAnswers[num];\r\n                const byText = filteredAnswers.findIndex((a) => a === txt);\r\n                if (byText !== -1) return byText;\r\n            }\r\n            // אם לא הצלחנו למפות דרך טקסט – ננסה ישירות על filtered\r\n            if (num >= 1 && num <= filteredAnswers.length) return num - 1;\r\n            if (num >= 0 && num < filteredAnswers.length) return num;\r\n        }\r\n    }\r\n\r\n    // 3) ברירת מחדל\r\n    return 0;\r\n}\r\n\r\n/** נרמול רשומת שאלה אחת מכל פורמט נפוץ */\r\nfunction normalizeRow(row) {\r\n    const question =\r\n        row?.question ??\r\n        row?.question_text ??\r\n        row?.q_text ??\r\n        row?.title ??\r\n        \"\";\r\n\r\n    // answers כבר כמערך?\r\n    if (Array.isArray(row?.answers)) {\r\n        const answers = row.answers.map((x) => (x == null ? \"\" : String(x)));\r\n        const idx = normalizeCorrectIndex({\r\n            baseAnswers: answers,\r\n            filteredAnswers: answers,\r\n            rawIndex:\r\n                row.correctAnswerIndex ??\r\n                row.correct_answer_index ??\r\n                row.correct_answer ??\r\n                row.correct ??\r\n                null,\r\n            rawText: row.correctAnswer ?? row.correct_answer_text ?? null,\r\n        });\r\n        return { question, answers, correctAnswerIndex: idx };\r\n    }\r\n\r\n    // עמודות answer_1..answer_4\r\n    const baseAnswers = [\r\n        row?.answer_1,\r\n        row?.answer_2,\r\n        row?.answer_3,\r\n        row?.answer_4,\r\n    ].map((x) => (x == null ? null : String(x)));\r\n\r\n    const answers = baseAnswers.filter((x) => x !== null);\r\n\r\n    const correctText =\r\n        row?.correctAnswer ??\r\n        row?.correct_answer_text ??\r\n        null;\r\n\r\n    const rawIndex =\r\n        row?.correctAnswerIndex ??\r\n        row?.correct_answer_index ??\r\n        row?.correct_answer ?? // יש מקרים שהעמודה נקראת כך\r\n        row?.correct ??\r\n        null;\r\n\r\n    const idx = normalizeCorrectIndex({\r\n        baseAnswers,\r\n        filteredAnswers: answers,\r\n        rawIndex,\r\n        rawText: correctText,\r\n    });\r\n\r\n    return { question, answers, correctAnswerIndex: idx };\r\n}\r\n\r\nconst QuizGame = ({ quizId: propQuizId, onFinish }) => {\r\n    const quizId = useQuizId(propQuizId);\r\n\r\n    const [questions, setQuestions] = useState([]);\r\n    const [currentIndex, setCurrentIndex] = useState(0);\r\n    const [feedback, setFeedback] = useState(\"\");\r\n    const [citizenCount, setCitizenCount] = useState(1);\r\n    const [score, setScore] = useState(0);\r\n    const [isLocked, setIsLocked] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [loadError, setLoadError] = useState(\"\");\r\n    const [finished, setFinished] = useState(false);\r\n\r\n    // טעינת שאלות\r\n    useEffect(() => {\r\n        let cancel = false;\r\n\r\n        async function load() {\r\n            setIsLoading(true);\r\n            setLoadError(\"\");\r\n            setQuestions([]);\r\n            setCurrentIndex(0);\r\n            setFeedback(\"\");\r\n            setCitizenCount(1);\r\n            setScore(0);\r\n            setIsLocked(false);\r\n            setFinished(false);\r\n\r\n            try {\r\n                const res = await fetch(`/api/questions/${quizId}`);\r\n                if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n                const raw = await res.json();\r\n\r\n                const normalized = (Array.isArray(raw) ? raw : []).map(normalizeRow);\r\n\r\n                if (!cancel) setQuestions(normalized);\r\n            } catch (e) {\r\n                console.error(\"Failed to fetch questions:\", e);\r\n                if (!cancel) setLoadError(\"Failed to load questions.\");\r\n            } finally {\r\n                if (!cancel) setIsLoading(false);\r\n            }\r\n        }\r\n\r\n        load();\r\n        return () => {\r\n            cancel = true;\r\n        };\r\n    }, [quizId]);\r\n\r\n    const currentQuestion = useMemo(\r\n        () => (questions.length ? questions[currentIndex] : null),\r\n        [questions, currentIndex]\r\n    );\r\n\r\n    if (!quizId) return <div>{Texts.no_quiz_selected}</div>;\r\n    if (isLoading) return <div>{Texts.loading_questions}</div>;\r\n    if (loadError) return <div>{loadError}</div>;\r\n    if (!currentQuestion) return <div>{Texts.loading_questions}</div>;\r\n\r\n    const handleAnswerClick = (index) => {\r\n        if (isLocked || finished) return;\r\n        setIsLocked(true);\r\n\r\n        const isCorrect = index === currentQuestion.correctAnswerIndex;\r\n\r\n        if (isCorrect) {\r\n            setFeedback(Texts.correct_answer_alert);\r\n            setScore((s) => s + 1);\r\n            setCitizenCount((prev) => Math.min(prev + 1, CIVILIANS.length));\r\n        } else {\r\n            setFeedback(Texts.wrong_answer_alert);\r\n            setCitizenCount((prev) => Math.max(prev - 1, 1));\r\n        }\r\n\r\n        setTimeout(() => {\r\n            setFeedback(\"\");\r\n            setIsLocked(false);\r\n\r\n            setCurrentIndex((prev) => {\r\n                const next = prev + 1;\r\n                if (next < questions.length) return next;\r\n\r\n                // סיום\r\n                const finalScore = isCorrect ? score + 1 : score;\r\n                setFinished(true);\r\n                if (typeof onFinish === \"function\") {\r\n                    onFinish({ score: finalScore, total: questions.length });\r\n                }\r\n                return prev;\r\n            });\r\n        }, 800);\r\n    };\r\n\r\n    const handleRestart = () => {\r\n        setCurrentIndex(0);\r\n        setFeedback(\"\");\r\n        setCitizenCount(1);\r\n        setScore(0);\r\n        setIsLocked(false);\r\n        setFinished(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"quiz-container\">\r\n            {/* LEFT */}\r\n            <div className=\"left-side\">\r\n                <div className=\"info-panel\">\r\n                    <div className=\"citizen-count-box\">\r\n                        {Texts.citizen_counter_label} {citizenCount}\r\n                    </div>\r\n\r\n                    <div className={`feedback-box ${feedback ? \"visible\" : \"\"}`}>\r\n                        {feedback}\r\n                    </div>\r\n\r\n                    <div className=\"game-frame\">\r\n                        <div className=\"citizens-panel\">\r\n                            {CIVILIANS.slice(0, citizenCount).map((src, idx) => (\r\n                                <img\r\n                                    key={idx}\r\n                                    src={src}\r\n                                    alt={`Citizen ${idx + 1}`}\r\n                                    className=\"citizen-img\"\r\n                                />\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* RIGHT */}\r\n            <div className=\"right-side\">\r\n                {finished ? (\r\n                    <div className=\"end-screen\">\r\n                        <h3>{Texts.end_title}</h3>\r\n                        <p>{Texts.end_summary(score, questions.length)}</p>\r\n                        <button className=\"restart-button\" onClick={handleRestart}>\r\n                            {Texts.restart}\r\n                        </button>\r\n                    </div>\r\n                ) : (\r\n                    <>\r\n                        <div className=\"question-box\">{currentQuestion.question}</div>\r\n                        <div className=\"answers-grid\">\r\n                            {currentQuestion.answers.map((ans, idx) => (\r\n                                <button\r\n                                    key={idx}\r\n                                    className=\"answer-button\"\r\n                                    onClick={() => handleAnswerClick(idx)}\r\n                                    disabled={isLocked}\r\n                                >\r\n                                    {ans}\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default QuizGame;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}