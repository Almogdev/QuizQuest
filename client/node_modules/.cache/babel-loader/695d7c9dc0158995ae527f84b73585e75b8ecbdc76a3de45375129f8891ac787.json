{"ast":null,"code":"import _objectSpread from\"D:/QuizQuest/QuizQuest/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useState}from\"react\";import\"./SchoolList.css\";/**\r\n * Expected server response (array):\r\n * [{ id, rank?, name, city, score, logo }]\r\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SchoolList=()=>{const[schools,setSchools]=useState([]);const[loading,setLoading]=useState(true);const[err,setErr]=useState(\"\");useEffect(()=>{let isMounted=true;const load=async()=>{try{setLoading(true);setErr(\"\");const res=await fetch(\"/api/leaderboard\");if(!res.ok)throw new Error(\"Failed to fetch leaderboard\");const data=await res.json();if(!isMounted)return;setSchools(Array.isArray(data)?data:[]);}catch(e){if(isMounted){setErr(e.message);setSchools([]);// no demo fallback\n}}finally{if(isMounted)setLoading(false);}};load();return()=>isMounted=false;},[]);// Sort by score desc and assign rank if missing\nconst ranked=useMemo(()=>{const copy=[...schools].sort((a,b)=>{var _b$score,_a$score;return((_b$score=b.score)!==null&&_b$score!==void 0?_b$score:0)-((_a$score=a.score)!==null&&_a$score!==void 0?_a$score:0);});return copy.map((s,i)=>{var _s$rank;return _objectSpread(_objectSpread({},s),{},{rank:(_s$rank=s.rank)!==null&&_s$rank!==void 0?_s$rank:i+1});});},[schools]);const podium=ranked.slice(0,3);const rest=ranked.slice(3);return/*#__PURE__*/_jsxs(\"section\",{className:\"lb-container\",\"aria-label\":\"Leaderboard\",children:[loading&&/*#__PURE__*/_jsx(\"div\",{className:\"lb-status\",children:\"Loading\\u2026\"}),!loading&&err&&/*#__PURE__*/_jsx(\"div\",{className:\"lb-status lb-error\",children:err}),/*#__PURE__*/_jsxs(\"div\",{className:\"lb-podium\",dir:\"rtl\",children:[podium[1]&&/*#__PURE__*/_jsx(PodiumCard,{place:2,school:podium[1]}),podium[0]&&/*#__PURE__*/_jsx(PodiumCard,{place:1,school:podium[0],highlight:true}),podium[2]&&/*#__PURE__*/_jsx(PodiumCard,{place:3,school:podium[2]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"lb-list\",dir:\"rtl\",children:rest.map(s=>{var _s$id;return/*#__PURE__*/_jsx(RowItem,{school:s},(_s$id=s.id)!==null&&_s$id!==void 0?_s$id:s.rank);})})]});};const PodiumCard=_ref=>{let{place,school={},highlight=false}=_ref;const{name=\"School name\",city=\"City\",score=0,logo}=school;const placeClass=place===1?\"gold\":place===2?\"silver\":place===3?\"bronze\":\"\";return/*#__PURE__*/_jsxs(\"article\",{className:\"podium-card \".concat(placeClass,\" \").concat(highlight?\"highlight\":\"\"),role:\"article\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rank-badge\",children:place}),/*#__PURE__*/_jsx(Logo,{logo:logo,name:name}),/*#__PURE__*/_jsx(\"h3\",{className:\"school-name\",title:name,children:name}),/*#__PURE__*/_jsx(\"div\",{className:\"school-city\",children:city}),/*#__PURE__*/_jsx(\"div\",{className:\"school-score\",children:score.toLocaleString()})]});};const RowItem=_ref2=>{let{school={}}=_ref2;const{rank=\"-\",name=\"School name\",city=\"City\",score=0,logo}=school;return/*#__PURE__*/_jsxs(\"article\",{className:\"row-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row-rank\",children:rank}),/*#__PURE__*/_jsx(\"div\",{className:\"row-name\",title:name,children:name}),/*#__PURE__*/_jsx(\"div\",{className:\"row-city\",children:city}),/*#__PURE__*/_jsx(\"div\",{className:\"row-score\",children:score.toLocaleString()}),/*#__PURE__*/_jsx(\"div\",{className:\"row-logo\",children:/*#__PURE__*/_jsx(Logo,{small:true,logo:logo,name:name})})]});};const Logo=_ref3=>{let{logo,name,small=false}=_ref3;if(logo){return/*#__PURE__*/_jsx(\"img\",{className:\"logo \".concat(small?\"logo-sm\":\"\"),src:logo,alt:\"\".concat(name,\" logo\"),loading:\"lazy\"});}// Fallback avatar with initials\nconst initials=(name||\"S N\").split(\" \").map(w=>w[0]).join(\"\").slice(0,2).toUpperCase();return/*#__PURE__*/_jsx(\"div\",{className:\"logo avatar \".concat(small?\"logo-sm\":\"\"),\"aria-label\":\"\".concat(name,\" logo\"),children:initials});};export default SchoolList;","map":{"version":3,"names":["React","useEffect","useMemo","useState","jsx","_jsx","jsxs","_jsxs","SchoolList","schools","setSchools","loading","setLoading","err","setErr","isMounted","load","res","fetch","ok","Error","data","json","Array","isArray","e","message","ranked","copy","sort","a","b","_b$score","_a$score","score","map","s","i","_s$rank","_objectSpread","rank","podium","slice","rest","className","children","dir","PodiumCard","place","school","highlight","_s$id","RowItem","id","_ref","name","city","logo","placeClass","concat","role","Logo","title","toLocaleString","_ref2","small","_ref3","src","alt","initials","split","w","join","toUpperCase"],"sources":["D:/QuizQuest/QuizQuest/client/src/components/SchoolsList/SchoolList.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from \"react\";\r\nimport \"./SchoolList.css\";\r\n\r\n/**\r\n * Expected server response (array):\r\n * [{ id, rank?, name, city, score, logo }]\r\n */\r\nconst SchoolList = () => {\r\n    const [schools, setSchools] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [err, setErr] = useState(\"\");\r\n\r\n    useEffect(() => {\r\n        let isMounted = true;\r\n        const load = async () => {\r\n            try {\r\n                setLoading(true);\r\n                setErr(\"\");\r\n                const res = await fetch(\"/api/leaderboard\");\r\n                if (!res.ok) throw new Error(\"Failed to fetch leaderboard\");\r\n                const data = await res.json();\r\n                if (!isMounted) return;\r\n                setSchools(Array.isArray(data) ? data : []);\r\n            } catch (e) {\r\n                if (isMounted) {\r\n                    setErr(e.message);\r\n                    setSchools([]); // no demo fallback\r\n                }\r\n            } finally {\r\n                if (isMounted) setLoading(false);\r\n            }\r\n        };\r\n        load();\r\n        return () => (isMounted = false);\r\n    }, []);\r\n\r\n    // Sort by score desc and assign rank if missing\r\n    const ranked = useMemo(() => {\r\n        const copy = [...schools].sort((a, b) => (b.score ?? 0) - (a.score ?? 0));\r\n        return copy.map((s, i) => ({ ...s, rank: s.rank ?? i + 1 }));\r\n    }, [schools]);\r\n\r\n    const podium = ranked.slice(0, 3);\r\n    const rest = ranked.slice(3);\r\n\r\n    return (\r\n        <section className=\"lb-container\" aria-label=\"Leaderboard\">\r\n            {loading && <div className=\"lb-status\">Loadingâ€¦</div>}\r\n            {!loading && err && <div className=\"lb-status lb-error\">{err}</div>}\r\n\r\n            {/* PODIUM (Top 3) */}\r\n            <div className=\"lb-podium\" dir=\"rtl\">\r\n                {podium[1] && <PodiumCard place={2} school={podium[1]} />}\r\n                {podium[0] && <PodiumCard place={1} school={podium[0]} highlight />}\r\n                {podium[2] && <PodiumCard place={3} school={podium[2]} />}\r\n            </div>\r\n\r\n            {/* LIST (4+) */}\r\n            <div className=\"lb-list\" dir=\"rtl\">\r\n                {rest.map((s) => (\r\n                    <RowItem key={s.id ?? s.rank} school={s} />\r\n                ))}\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nconst PodiumCard = ({ place, school = {}, highlight = false }) => {\r\n    const { name = \"School name\", city = \"City\", score = 0, logo } = school;\r\n\r\n    const placeClass =\r\n        place === 1 ? \"gold\" : place === 2 ? \"silver\" : place === 3 ? \"bronze\" : \"\";\r\n\r\n    return (\r\n        <article className={`podium-card ${placeClass} ${highlight ? \"highlight\" : \"\"}`} role=\"article\">\r\n            <div className=\"rank-badge\">{place}</div>\r\n            <Logo logo={logo} name={name} />\r\n            <h3 className=\"school-name\" title={name}>{name}</h3>\r\n            <div className=\"school-city\">{city}</div>\r\n            <div className=\"school-score\">{score.toLocaleString()}</div>\r\n        </article>\r\n    );\r\n};\r\n\r\nconst RowItem = ({ school = {} }) => {\r\n    const { rank = \"-\", name = \"School name\", city = \"City\", score = 0, logo } = school;\r\n    return (\r\n        <article className=\"row-item\">\r\n            <div className=\"row-rank\">{rank}</div>\r\n            <div className=\"row-name\" title={name}>{name}</div>\r\n            <div className=\"row-city\">{city}</div>\r\n            <div className=\"row-score\">{score.toLocaleString()}</div>\r\n            <div className=\"row-logo\"><Logo small logo={logo} name={name} /></div>\r\n        </article>\r\n    );\r\n};\r\n\r\nconst Logo = ({ logo, name, small = false }) => {\r\n    if (logo) {\r\n        return (\r\n            <img\r\n                className={`logo ${small ? \"logo-sm\" : \"\"}`}\r\n                src={logo}\r\n                alt={`${name} logo`}\r\n                loading=\"lazy\"\r\n            />\r\n        );\r\n    }\r\n    // Fallback avatar with initials\r\n    const initials = (name || \"S N\")\r\n        .split(\" \")\r\n        .map((w) => w[0])\r\n        .join(\"\")\r\n        .slice(0, 2)\r\n        .toUpperCase();\r\n\r\n    return (\r\n        <div className={`logo avatar ${small ? \"logo-sm\" : \"\"}`} aria-label={`${name} logo`}>\r\n            {initials}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SchoolList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}